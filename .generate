#! /bin/bash

if [[ -z "$OUT" ]]; then
  OUT="."
fi

# /dev/myself output regex
TEST_REGEX="[+-](T(2[0-1]|1[0-9]|[0-9])|[CSPW](1[0-4]|[1-9])){1}"

# grab a card
TAROT="$(sudo head -c 4 /dev/myself | tr -d '\0')";

# write to .myself
echo $TAROT > "$OUT/.myself"

# read from .myself
cat $OUT/.myself

# test regex and exit
if [[ "$TAROT" =~ $TEST_REGEX ]]; then
  exit 0;
else
  exit 1;
fi
